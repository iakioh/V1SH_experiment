<?xml version="1.0" ?>
<PsychoPy2experiment encoding="utf-8" version="2025.1.1">
  <Settings>
    <Param val="ptb" valType="str" updates="None" name="Audio lib"/>
    <Param val="" valType="str" updates="None" name="Completed URL"/>
    <Param val="auto" valType="str" updates="None" name="Data file delimiter"/>
    <Param val="u'../../data/%s/ID%sS%s_%s_%s_%s/ID%sS%s_%s_%s_%s' % (expInfo['save_in'], expInfo['ID'], expInfo['session'], expInfo['surname'], expInfo['first_name'], expInfo['date'], expInfo['ID'], expInfo['session'], expInfo['surname'], expInfo['first_name'], expInfo['date'])" valType="code" updates="None" name="Data filename"/>
    <Param val="True" valType="bool" updates="None" name="Enable Escape"/>
    <Param val="Thank you for your patience." valType="str" updates="None" name="End Message"/>
    <Param val="{'monitor_type': 'HP ProBook 450 G8 Notebook PC', 'mean_luminance_cdpm2': 'unknown', 'viewing_distance_cm': '60', 'save_in': 'personal', 'session': '01', 'session_to_load': 'none', 'ID': '001', 'first_name': 'Kai', 'surname': 'Rothe', 'age': '25', 'gender': 'male', 'visual_acuity_left_dpt': 'approx. -2 to -3', 'visual_acuity_right_dpt': 'approx. -2 to -3', 'visual_acuity_corrected': 'True', 'handedness': 'unknown', 'eye_dominance': 'unknown', 'diseases': 'unknown', 'subject_comments': '', 'skip_instructions': 'False', 'skip_training': 'False', 'skip_testing': 'False', 'monkey_mode': 'False'}" valType="code" updates="None" name="Experiment info"/>
    <Param val="True" valType="bool" updates="None" name="Force stereo"/>
    <Param val="True" valType="bool" updates="None" name="Full-screen window"/>
    <Param val="" valType="str" updates="None" name="HTML path"/>
    <Param val="" valType="str" updates="None" name="Incomplete URL"/>
    <Param val="HP ProBook 450 G8 Notebook PC" valType="str" updates="None" name="Monitor"/>
    <Param val="[]" valType="list" updates="None" name="Resources"/>
    <Param val="True" valType="bool" updates="None" name="Save csv file"/>
    <Param val="True" valType="bool" updates="None" name="Save excel file"/>
    <Param val="False" valType="bool" updates="None" name="Save hdf5 file"/>
    <Param val="True" valType="bool" updates="None" name="Save log file"/>
    <Param val="True" valType="bool" updates="None" name="Save psydat file"/>
    <Param val="True" valType="bool" updates="None" name="Save wide csv file"/>
    <Param val="1" valType="num" updates="None" name="Screen"/>
    <Param val="True" valType="bool" updates="None" name="Show info dlg"/>
    <Param val="False" valType="bool" updates="None" name="Show mouse"/>
    <Param val="height" valType="str" updates="None" name="Units"/>
    <Param val="2025.1.1" valType="str" updates="None" name="Use version"/>
    <Param val="[1920, 1080]" valType="list" updates="None" name="Window size (pixels)"/>
    <Param val="none" valType="str" updates="None" name="backgroundFit"/>
    <Param val="" valType="str" updates="None" name="backgroundImg"/>
    <Param val="avg" valType="str" updates="None" name="blendMode"/>
    <Param val="float" valType="str" updates="None" name="clockFormat"/>
    <Param val="{'thisRow.t': 'priority.CRITICAL', 'expName': 'priority.LOW'}" valType="dict" updates="None" name="colPriority"/>
    <Param val="$[0,0,0]" valType="color" updates="None" name="color"/>
    <Param val="rgb" valType="str" updates="None" name="colorSpace"/>
    <Param val="warning" valType="code" updates="None" name="consoleLoggingLevel"/>
    <Param val="default" valType="str" updates="None" name="ecSampleRate"/>
    <Param val="100.1.1.1" valType="str" updates="None" name="elAddress"/>
    <Param val="FILTER_LEVEL_2" valType="str" updates="None" name="elDataFiltering"/>
    <Param val="FILTER_LEVEL_OFF" valType="str" updates="None" name="elLiveFiltering"/>
    <Param val="EYELINK 1000 DESKTOP" valType="str" updates="None" name="elModel"/>
    <Param val="ELLIPSE_FIT" valType="str" updates="None" name="elPupilAlgorithm"/>
    <Param val="PUPIL_AREA" valType="str" updates="None" name="elPupilMeasure"/>
    <Param val="1000" valType="num" updates="None" name="elSampleRate"/>
    <Param val="False" valType="bool" updates="None" name="elSimMode"/>
    <Param val="RIGHT_EYE" valType="str" updates="None" name="elTrackEyes"/>
    <Param val="PUPIL_CR_TRACKING" valType="str" updates="None" name="elTrackingMode"/>
    <Param val="experiment" valType="str" updates="None" name="expName"/>
    <Param val="" valType="str" updates="None" name="expVersion"/>
    <Param val="on Sync" valType="str" updates="None" name="exportHTML"/>
    <Param val="None" valType="str" updates="None" name="eyetracker"/>
    <Param val="" valType="code" updates="None" name="frameRate"/>
    <Param val="Attempting to measure frame rate of screen, please wait..." valType="str" updates="None" name="frameRateMsg"/>
    <Param val="127.0.0.1" valType="str" updates="None" name="gpAddress"/>
    <Param val="4242" valType="num" updates="None" name="gpPort"/>
    <Param val="PsychToolbox" valType="str" updates="None" name="keyboardBackend"/>
    <Param val="info" valType="code" updates="None" name="logging level"/>
    <Param val="True" valType="bool" updates="None" name="measureFrameRate"/>
    <Param val="('MIDDLE_BUTTON',)" valType="list" updates="None" name="mgBlink"/>
    <Param val="CONTINUOUS" valType="str" updates="None" name="mgMove"/>
    <Param val="0.5" valType="num" updates="None" name="mgSaccade"/>
    <Param val="neon.local" valType="str" updates="None" name="plCompanionAddress"/>
    <Param val="8080" valType="num" updates="None" name="plCompanionPort"/>
    <Param val="0.6" valType="num" updates="None" name="plConfidenceThreshold"/>
    <Param val="" valType="str" updates="None" name="plPupilCaptureRecordingLocation"/>
    <Param val="127.0.0.1" valType="str" updates="None" name="plPupilRemoteAddress"/>
    <Param val="50020" valType="num" updates="None" name="plPupilRemotePort"/>
    <Param val="1000" valType="num" updates="None" name="plPupilRemoteTimeoutMs"/>
    <Param val="False" valType="bool" updates="None" name="plPupillometryOnly"/>
    <Param val="psychopy_iohub_surface" valType="str" updates="None" name="plSurfaceName"/>
    <Param val="1" valType="code" updates="None" name="runMode"/>
    <Param val="True" valType="bool" updates="None" name="rush"/>
    <Param val="time" valType="str" updates="None" name="sortColumns"/>
    <Param val="" valType="str" updates="None" name="tbLicenseFile"/>
    <Param val="" valType="str" updates="None" name="tbModel"/>
    <Param val="60" valType="num" updates="None" name="tbSampleRate"/>
    <Param val="60" valType="str" updates="None" name="tbSamplingRate"/>
    <Param val="" valType="str" updates="None" name="tbSerialNo"/>
    <Param val="BINOCULAR" valType="str" updates="None" name="tbTrackEyes"/>
    <Param val="pyglet" valType="str" updates="None" name="winBackend"/>
  </Settings>
  <Routines>
    <Routine name="Preparation">
      <RoutineSettingsComponent name="Preparation" plugin="None">
        <Param val="none" valType="str" updates="None" name="backgroundFit"/>
        <Param val="" valType="str" updates="None" name="backgroundImg"/>
        <Param val="$[0,0,0]" valType="color" updates="None" name="color"/>
        <Param val="rgb" valType="str" updates="None" name="colorSpace"/>
        <Param val="" valType="str" updates="constant" name="desc"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="False" valType="code" updates="None" name="forceNonSlip"/>
        <Param val="Preparation" valType="code" updates="None" name="name"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="constant" name="skipIf"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="False" valType="bool" updates="None" name="useWindowParams"/>
      </RoutineSettingsComponent>
      <CodeComponent name="GetExperimentalInfo" plugin="None">
        <Param val="import yaml&amp;#10;from numpy.random import default_rng&amp;#10;import math&amp;#10;import pandas as pd&amp;#10;import itertools&amp;#10;import atexit&amp;#10;import shutil&amp;#10;from datetime import datetime&amp;#10;import questplus&amp;#10;import json&amp;#10;import pickle&amp;#10;import random&amp;#10;&amp;#10;# Parameters loaded / calculated from file&amp;#10;ExpInfo_path = os.path.join(os.path.dirname(__file__), '../ExpInfo.yaml')&amp;#10;with open(ExpInfo_path, 'r') as f:&amp;#10;    ExpInfo = yaml.safe_load(f)&amp;#10;&amp;#10;StimInfo = ExpInfo[&quot;Stimulus&quot;]&amp;#10;&amp;#10;nTrials_test = ExpInfo[&quot;Procedure&amp;Conditions&quot;][&quot;NumberOfTrials&quot;]&amp;#10;nTrials_train = ExpInfo[&quot;Procedure&amp;Conditions&quot;][&quot;NumberOfPracticeTrials&quot;]&amp;#10;track_time = ExpInfo[&quot;Procedure&amp;Conditions&quot;][&quot;MaxTime_min&quot;] is not None&amp;#10;if track_time:&amp;#10;    MAX_TIME_s = 60 * ExpInfo[&quot;Procedure&amp;Conditions&quot;][&quot;MaxTime_min&quot;] # s&amp;#10;    practice_start_time_s = None&amp;#10;&amp;#10;    &amp;#10;seed = ExpInfo[&quot;Procedure&amp;Conditions&quot;][&quot;RandomSeed&quot;]&amp;#10;if seed is not None:&amp;#10;    raise Warning(&quot;Should randomize over subjects and sessions.&quot;)&amp;#10;else:&amp;#10;    now = datetime.now()&amp;#10;    # times of seconds since Jan 1, 1970 UTC&amp;#10;    # * 1000000 to get microsecond variability&amp;#10;    # modulo 2**31 to avoid overflow&amp;#10;    # int32 since required type of seed for numpy&amp;#10;    seed = np.int32(int(datetime.now().timestamp() * 1000000) % (2**31))  # e.g., 20251208143052&amp;#10;    rng = default_rng(seed)&amp;#10;    ExpInfo[&quot;Procedure&amp;Conditions&quot;][&quot;RandomSeed&quot;] = int(seed)&amp;#10;&amp;#10;frequency = StimInfo[&quot;GaborPatch&quot;][&quot;SpatialFrequency_cpd&quot;] # cycles per degree&amp;#10;orientations_degrees = StimInfo[&quot;GaborPatch&quot;][&quot;Orientation_degrees&quot;] # degrees&amp;#10;mitchell_contrast = StimInfo[&quot;GaborPatch&quot;][&quot;MitchellContrast&quot;] &amp;#10;sigma = StimInfo[&quot;GaborPatch&quot;][&quot;Sigma_degrees&quot;] # degrees&amp;#10;assert StimInfo[&quot;GaborPatch&quot;][&quot;PatchSize_sigma&quot;] == 6, &quot;Gabor patch size must be 6 sigma&quot;&amp;#10;spacing = StimInfo[&quot;GaborPatch&quot;][&quot;PatchSize_sigma&quot;] * sigma  # degrees&amp;#10;jitter_amount = StimInfo[&quot;Jitter&quot;][&quot;Range_sigma&quot;] * sigma  # max jitter in degrees&amp;#10;&amp;#10;n_rows = StimInfo[&quot;Grid&quot;][&quot;Rows&quot;]&amp;#10;vertical_seperation = StimInfo[&quot;VerticalSeperation_degrees&quot;] # degrees&amp;#10;&amp;#10;x_eccentricity_degrees = StimInfo[&quot;Eccentricity_degrees&quot;][&quot;x&quot;] # degrees&amp;#10;y_eccentricity_degrees = StimInfo[&quot;Eccentricity_degrees&quot;][&quot;y&quot;] # degrees&amp;#10;&amp;#10;displacement_range_cols = [StimInfo[&quot;HorizontalDisplacement_cols&quot;][&quot;Minimum&quot;], StimInfo[&quot;HorizontalDisplacement_cols&quot;][&quot;Maximum&quot;]] # columns&amp;#10;displacement_step_cols = StimInfo[&quot;HorizontalDisplacement_cols&quot;][&quot;StepSize&quot;] # columns&amp;#10;displacements_cols = np.arange(displacement_range_cols[0], displacement_range_cols[1] + displacement_step_cols, displacement_step_cols)&amp;#10;&amp;#10;fixation_shape = StimInfo[&quot;Fixation&quot;][&quot;Shape&quot;]&amp;#10;fixation_duration = StimInfo[&quot;Fixation&quot;][&quot;Duration_s&quot;] # seconds&amp;#10;fixation_diameter = StimInfo[&quot;Fixation&quot;][&quot;Diameter_degrees&quot;] # degrees&amp;#10;central_exclusion_zone_shape = StimInfo[&quot;CentralExclusionZone&quot;][&quot;Shape&quot;]&amp;#10;central_exclusion_width_degrees = StimInfo[&quot;CentralExclusionZone&quot;][&quot;Width_degrees&quot;] # degrees&amp;#10;central_exclusion_height_degrees = StimInfo[&quot;CentralExclusionZone&quot;][&quot;Height_degrees&quot;] # degrees&amp;#10;&amp;#10;mean_range_cols = [ExpInfo[&quot;Procedure&amp;Conditions&quot;][&quot;Staircase&quot;][&quot;Mean_cols&quot;][&quot;Minimum&quot;], ExpInfo[&quot;Procedure&amp;Conditions&quot;][&quot;Staircase&quot;][&quot;Mean_cols&quot;][&quot;Maximum&quot;]] # columns&amp;#10;mean_step_cols = ExpInfo[&quot;Procedure&amp;Conditions&quot;][&quot;Staircase&quot;][&quot;Mean_cols&quot;][&quot;StepSize&quot;] # columns&amp;#10;means_cols = np.arange(mean_range_cols[0], mean_range_cols[1] + mean_step_cols, mean_step_cols)&amp;#10;std_range_cols = [ExpInfo[&quot;Procedure&amp;Conditions&quot;][&quot;Staircase&quot;][&quot;StandardDeviation_cols&quot;][&quot;Minimum&quot;], ExpInfo[&quot;Procedure&amp;Conditions&quot;][&quot;Staircase&quot;][&quot;StandardDeviation_cols&quot;][&quot;Maximum&quot;]] # columns&amp;#10;std_step_cols = ExpInfo[&quot;Procedure&amp;Conditions&quot;][&quot;Staircase&quot;][&quot;StandardDeviation_cols&quot;][&quot;StepSize&quot;] # columns&amp;#10;stds_cols = np.arange(std_range_cols[0], std_range_cols[1] + std_step_cols, std_step_cols)&amp;#10;lapse_rates = np.array(ExpInfo[&quot;Procedure&amp;Conditions&quot;][&quot;Staircase&quot;][&quot;LapseRate&quot;])&amp;#10;&amp;#10;STAIRCASE = None # overwrite with selected staircase each trial later&amp;#10;STIMULUS_DICT = None&amp;#10;&amp;#10;# Ensure hardcoded parameters are correct&amp;#10;assert StimInfo[&quot;Fixation&quot;][&quot;Color&quot;] == &quot;white&quot;, &quot;Fixation stimulus should be set to 'white'.&quot;&amp;#10;assert StimInfo[&quot;Jitter&quot;][&quot;Type&quot;] == &quot;uniform&quot;, &quot;Spatial jitter distribution should be set to 'uniform'.&quot;&amp;#10;assert central_exclusion_zone_shape == &quot;ellipse&quot;, &quot;Central exclusion zone shape should be set to 'ellipse'.&quot;" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="# get expInfo for initializing the staircase later&amp;#10;subject_id = expInfo[&quot;ID&quot;]&amp;#10;session_to_load = expInfo[&quot;session_to_load&quot;]&amp;#10;assert session_to_load == &quot;none&quot; or session_to_load == &quot;last&quot; or session_to_load == &quot;all&quot;, &quot;session_to_load must be either 'none', 'all' or 'last'.&quot;&amp;#10;session_id_string = expInfo['session']&amp;#10;data_path = os.path.join(&quot;..&quot;, &quot;..&quot;, &quot;data&quot;, &quot;raw&quot;)&amp;#10;print(f&quot;Load sessions from data path as: {data_path}&quot;)&amp;#10;&amp;#10;# Pre-compute and select eccentricities&amp;#10;session_index = int(expInfo[&quot;session&quot;]) - 1 # expInfo[&quot;session&quot;] starts with &quot;001&quot;&amp;#10;abs_x_eccentricity_degrees = abs(x_eccentricity_degrees) / 2 # degrees&amp;#10;abs_y_eccentricity_degrees = abs(y_eccentricity_degrees) / 2 # degrees&amp;#10;eccentricities_degrees = [[abs_x_eccentricity_degrees, abs_y_eccentricity_degrees], [-abs_x_eccentricity_degrees, abs_y_eccentricity_degrees]] # upper left and right side&amp;#10;xy_eccentricity_degrees = eccentricities_degrees[session_index % 2]&amp;#10;&amp;#10;# Pre-compute timing&amp;#10;def get_frames_from_seconds(duration_s):&amp;#10;    refresh_rate = win.getActualFrameRate() # Hz&amp;#10;    return round(refresh_rate * duration_s)&amp;#10;&amp;#10;# name with &quot;_&quot; at the end to avoid clashes with global variables &amp;#10;# later injected through trial condition files&amp;#10;stimulus_duration_s_ = StimInfo[&quot;GaborPatch&quot;][&quot;Duration_s&quot;]&amp;#10;stimulus_frames_ = get_frames_from_seconds(stimulus_duration_s_)&amp;#10;fixation_frames = get_frames_from_seconds(fixation_duration)&amp;#10;blank_duration_s = StimInfo[&quot;Blank&quot;][&quot;Duration_s&quot;]&amp;#10;blank_frames = get_frames_from_seconds(blank_duration_s)&amp;#10;&amp;#10;# Pre-compute column number&amp;#10;&amp;#10;# Get monitor parameters&amp;#10;mon = win.monitor&amp;#10;viewing_distance = mon.getDistance()   # in cm&amp;#10;screen_width_cm = mon.getWidth()       # in cm&amp;#10;&amp;#10;# Compare with parameters by hand (dialog box)&amp;#10;assert expInfo['monitor_type'] == win.monitor.name, f&quot;Monitor setting (monitor type) incorrect: {win.monitor.name} (true) != {expInfo['monitor_type']} (given).&quot;&amp;#10;assert float(expInfo['viewing_distance_cm']) == viewing_distance, f&quot;Monitor setting (viewing distance) incorrect:  {win.monitor.getDistance()} (true) != {float(expInfo['viewing_distance_cm'])} (given).&quot;&amp;#10;&amp;#10;# Calculate screen width in visual degrees&amp;#10;# Formula: visual_angle = 2 * arctan(size_cm / (2 * distance_cm))&amp;#10;screen_width_degrees = 2 * np.degrees(np.arctan(screen_width_cm / (2 * viewing_distance)))&amp;#10;screen_width_cols = int(np.ceil(screen_width_degrees / spacing))&amp;#10;&amp;#10;# Calculate minimum number of columns to cover the screen&amp;#10;# Add 5 to each side to ensure we cover the whole screen, also edges&amp;#10;n_col_plus = 5&amp;#10;max_displacement_cols = int(max(displacement_range_cols[1], -displacement_range_cols[0])) # to allow shifting border&amp;#10;n_col = screen_width_cols + 2 * max_displacement_cols + 2 * n_col_plus &amp;#10;&amp;#10;# Assure even number of columns&amp;#10;if n_col % 2 == 1:&amp;#10;    n_col += 1" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="trial_variables = {&quot;n_row&quot;: None,&amp;#10;    &quot;displacement_cols&quot;: None,&amp;#10;    &quot;orientation_degrees&quot;: None,&amp;#10;    &quot;stimulus_duration_s&quot;: None,&amp;#10;    &quot;instruction&quot;: None,&amp;#10;    &quot;session&quot;: None,&amp;#10;    &quot;stimulus_frames&quot;: None,&amp;#10;    &quot;x_eccentricity_degrees&quot;: None,&amp;#10;    &quot;y_eccentricity_degrees&quot;: None,&amp;#10;    &quot;state&quot;: None,&amp;#10;    &quot;response&quot;: None}" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="GetExperimentalInfo" valType="code" updates="None" name="name"/>
      </CodeComponent>
      <CodeComponent name="GetTrialConditionSequence" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="# Create and save conditions sequence&amp;#10;&amp;#10;# instruction trials&amp;#10;instructions_filepath = &quot;../instructions.csv&quot; # hardcoded here&amp;#10;instruction_conditions_df = pd.read_csv(instructions_filepath) &amp;#10;instruction_conditions_df['session'] = session_index &amp;#10;instruction_conditions_df[&quot;stimulus_frames&quot;] = instruction_conditions_df[&quot;stimulus_duration_s&quot;].apply(get_frames_from_seconds)&amp;#10;instruction_conditions_df[&quot;x_eccentricity_degrees&quot;] = xy_eccentricity_degrees[0]&amp;#10;instruction_conditions_df[&quot;y_eccentricity_degrees&quot;] = xy_eccentricity_degrees[1]&amp;#10;instruction_conditions_df[&quot;state&quot;] = &quot;instruct&quot;&amp;#10;instruction_conditions_df.to_csv('conditions_temp_instruct.csv', index=False)&amp;#10;&amp;#10;# training trials&amp;#10;conditions = list(itertools.product(n_rows, displacements_cols, orientations_degrees))&amp;#10;&amp;#10;def sample_from(items, n_samples): &amp;#10;    # sample conditions randomly&amp;#10;    # if n_samples &lt; len(items): just sample randomly&amp;#10;    # else, select all samples (in random order) and sample the remainder&amp;#10;    samples = items * (n_samples // len(items)) + random.sample(items, n_samples % len(items))&amp;#10;    random.shuffle(samples) # in-place shuffeling&amp;#10;    return samples&amp;#10;conditions = sample_from(conditions, nTrials_train)&amp;#10;nReps_train = 1 &amp;#10;&amp;#10;conditions_df = pd.DataFrame(conditions, columns=['n_row', 'displacement_cols', 'orientation_degrees'])        &amp;#10;conditions_df['session'] = session_index &amp;#10;conditions_df[&quot;stimulus_frames&quot;] = stimulus_frames_&amp;#10;conditions_df[&quot;stimulus_duration_s&quot;] = stimulus_duration_s_&amp;#10;conditions_df[&quot;x_eccentricity_degrees&quot;] = xy_eccentricity_degrees[0]&amp;#10;conditions_df[&quot;y_eccentricity_degrees&quot;] = xy_eccentricity_degrees[1]&amp;#10;conditions_df[&quot;state&quot;] = &quot;train&quot;&amp;#10;conditions_df[&quot;instruction&quot;] = None&amp;#10;conditions_df.to_csv('conditions_temp_train.csv', index=False)&amp;#10;&amp;#10;# testing trials: psi staircase + randomize over conditions&amp;#10;conditions = list(itertools.product(n_rows, orientations_degrees))&amp;#10;nReps_test = int(math.ceil(nTrials_test / len(conditions)))&amp;#10;&amp;#10;def get_key(n_row, orientation_degrees):&amp;#10;    # % 90 to combine staircase inference for symmetrically oriented textures&amp;#10;    return f&quot;n_row={n_row}_orientation_degrees={orientation_degrees % 90}&quot;&amp;#10;&amp;#10;staircases = {}&amp;#10;for n, o in conditions:&amp;#10;    assert 0 &lt;= o &lt; 180, &quot;Orientations must be in [0, 180) degree range.&quot;&amp;#10;    key = get_key(n, o)&amp;#10;    if key not in staircases:&amp;#10;        staircases[key] = questplus.qp.QuestPlus(&amp;#10;            stim_domain = {&quot;intensity&quot;: displacements_cols}, # displacement min &amp; max&amp;#10;            param_domain = {&quot;mean&quot;: means_cols, &quot;sd&quot;: stds_cols, &quot;lapse_rate&quot;: lapse_rates},&amp;#10;            outcome_domain = {&quot;response&quot;: [1, 0]},&amp;#10;            func = &quot;norm_cdf_2&quot;, # assumes lapse rate == lower asymptote&amp;#10;            stim_scale = &quot;linear&quot;&amp;#10;        )&amp;#10;&amp;#10;if session_to_load != &quot;none&quot;: &amp;#10;    # initialize staircases with data from previous / last session&amp;#10;    for root, _, files in os.walk(data_path):&amp;#10;        directory_name = os.path.basename(root) &amp;#10;        last_session_id_string = f&quot;{int(session_id_string)-1:02d}&quot;&amp;#10;        if (session_to_load == &quot;all&quot; and directory_name[:5] == f&quot;ID{subject_id}&quot;) or (session_to_load == &quot;last&quot; and directory_name[:8] == f&quot;ID{subject_id}S{last_session_id_string}&quot;):&amp;#10;            for key, staircase in staircases.items():&amp;#10;                for file in files: &amp;#10;                    if file == &quot;questplus_staircase_&quot; + key + &quot;.json&quot;:&amp;#10;                        # Load previous stimulus response pairs&amp;#10;                        file_path = os.path.join(root, file)&amp;#10;                        previous_stimuli = []&amp;#10;                        previous_responses = []&amp;#10;                        with open(file_path, 'r') as f:  # Open in text mode&amp;#10;                            text = f.read()  # Load JSON data&amp;#10;                            previous_staircase = questplus.qp.QuestPlus.from_json(text)&amp;#10;                            previous_stimuli = previous_staircase.stim_history&amp;#10;                            previous_responses = previous_staircase.resp_history&amp;#10;                        &amp;#10;                        # Update staircase&amp;#10;                        print(f&quot;Updating staircase {key} with data {directory_name}/{file}&quot;)&amp;#10;                        for stim, resp in zip(previous_stimuli, previous_responses):&amp;#10;                            # print(stim, resp)&amp;#10;                            staircase.update(stim = stim, outcome = resp)&amp;#10; &amp;#10;conditions_df = pd.DataFrame(conditions, columns=['n_row', 'orientation_degrees'])  &amp;#10;conditions_df['session'] = session_index&amp;#10;conditions_df['stimulus_frames'] = stimulus_frames_&amp;#10;conditions_df['stimulus_duration_s'] = stimulus_duration_s_&amp;#10;conditions_df['x_eccentricity_degrees'] = xy_eccentricity_degrees[0]&amp;#10;conditions_df['y_eccentricity_degrees'] = xy_eccentricity_degrees[1]&amp;#10;conditions_df['state'] = 'test'&amp;#10;conditions_df[&quot;instruction&quot;] = None&amp;#10;conditions_df.to_csv('conditions_temp_test.csv', index=False)" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="GetTrialConditionSequence" valType="code" updates="None" name="name"/>
      </CodeComponent>
    </Routine>
    <Routine name="Fixation">
      <RoutineSettingsComponent name="Fixation" plugin="None">
        <Param val="none" valType="str" updates="None" name="backgroundFit"/>
        <Param val="" valType="str" updates="None" name="backgroundImg"/>
        <Param val="$[0,0,0]" valType="color" updates="None" name="color"/>
        <Param val="rgb" valType="str" updates="None" name="colorSpace"/>
        <Param val="" valType="str" updates="constant" name="desc"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="False" valType="code" updates="None" name="forceNonSlip"/>
        <Param val="Fixation" valType="code" updates="None" name="name"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="constant" name="skipIf"/>
        <Param val="frame N" valType="str" updates="None" name="stopType"/>
        <Param val="fixation_frames" valType="code" updates="constant" name="stopVal"/>
        <Param val="False" valType="bool" updates="None" name="useWindowParams"/>
      </RoutineSettingsComponent>
      <CodeComponent name="SetBackground_2" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="win.color = [0, 0, 0] # keep grey background" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="SetBackground_2" valType="code" updates="None" name="name"/>
      </CodeComponent>
      <PolygonComponent name="CentralExclusionZone_2" plugin="None">
        <Param val="center" valType="str" updates="constant" name="anchor"/>
        <Param val="rgb" valType="str" updates="constant" name="colorSpace"/>
        <Param val="1" valType="num" updates="constant" name="contrast"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="False" valType="code" updates="constant" name="draggable"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="[0,0,0]" valType="color" updates="constant" name="fillColor"/>
        <Param val="linear" valType="str" updates="constant" name="interpolate"/>
        <Param val="white" valType="color" updates="constant" name="lineColor"/>
        <Param val="2" valType="num" updates="constant" name="lineWidth"/>
        <Param val="4" valType="int" updates="constant" name="nVertices"/>
        <Param val="CentralExclusionZone_2" valType="code" updates="None" name="name"/>
        <Param val="" valType="num" updates="constant" name="opacity"/>
        <Param val="0" valType="num" updates="constant" name="ori"/>
        <Param val="(-x_eccentricity_degrees, -y_eccentricity_degrees)" valType="list" updates="set every repeat" name="pos"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="circle" valType="str" updates="None" name="shape"/>
        <Param val="(central_exclusion_width_degrees, central_exclusion_height_degrees)" valType="list" updates="constant" name="size"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="0.0" valType="code" updates="None" name="startVal"/>
        <Param val="frame N" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="True" valType="bool" updates="None" name="syncScreenRefresh"/>
        <Param val="deg" valType="str" updates="None" name="units"/>
        <Param val="" valType="code" updates="None" name="validator"/>
        <Param val="" valType="list" updates="constant" name="vertices"/>
      </PolygonComponent>
      <PolygonComponent name="FixationShape_1" plugin="None">
        <Param val="center" valType="str" updates="constant" name="anchor"/>
        <Param val="rgb" valType="str" updates="constant" name="colorSpace"/>
        <Param val="1" valType="num" updates="constant" name="contrast"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="False" valType="code" updates="constant" name="draggable"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="white" valType="color" updates="constant" name="fillColor"/>
        <Param val="linear" valType="str" updates="constant" name="interpolate"/>
        <Param val="white" valType="color" updates="constant" name="lineColor"/>
        <Param val="1" valType="num" updates="constant" name="lineWidth"/>
        <Param val="4" valType="int" updates="constant" name="nVertices"/>
        <Param val="FixationShape_1" valType="code" updates="None" name="name"/>
        <Param val="" valType="num" updates="constant" name="opacity"/>
        <Param val="0" valType="num" updates="constant" name="ori"/>
        <Param val="(-x_eccentricity_degrees, -y_eccentricity_degrees)" valType="list" updates="set every repeat" name="pos"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="circle" valType="str" updates="None" name="shape"/>
        <Param val="(fixation_diameter, fixation_diameter)" valType="list" updates="constant" name="size"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="0" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="True" valType="bool" updates="None" name="syncScreenRefresh"/>
        <Param val="deg" valType="str" updates="None" name="units"/>
        <Param val="" valType="code" updates="None" name="validator"/>
        <Param val="" valType="list" updates="constant" name="vertices"/>
      </PolygonComponent>
    </Routine>
    <Routine name="Stimulus">
      <RoutineSettingsComponent name="Stimulus" plugin="None">
        <Param val="none" valType="str" updates="None" name="backgroundFit"/>
        <Param val="" valType="str" updates="None" name="backgroundImg"/>
        <Param val="$[0,0,0]" valType="color" updates="None" name="color"/>
        <Param val="rgb" valType="str" updates="None" name="colorSpace"/>
        <Param val="" valType="str" updates="constant" name="desc"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="False" valType="code" updates="None" name="forceNonSlip"/>
        <Param val="Stimulus" valType="code" updates="None" name="name"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="constant" name="skipIf"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="False" valType="bool" updates="None" name="useWindowParams"/>
      </RoutineSettingsComponent>
      <CodeComponent name="SetBackground_3" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="win.color = [0, 0, 0] # keep grey background" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="SetBackground_3" valType="code" updates="None" name="name"/>
      </CodeComponent>
      <CodeComponent name="UpdateVariablesAndStaircase" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="# Update trials variables (from globals)&amp;#10;for variable_name in trial_variables.keys():&amp;#10;    if variable_name != &quot;response&quot;:&amp;#10;        trial_variables[variable_name] = globals().get(variable_name, None)&amp;#10;&amp;#10;# Infer next horizontal displacement&amp;#10;if trial_variables[&quot;state&quot;] == &quot;test&quot;: # staircase during testing trials&amp;#10;    key = get_key(trial_variables[&quot;n_row&quot;], trial_variables[&quot;orientation_degrees&quot;])&amp;#10;    STAIRCASE = staircases[key] # overwrite from previous trial (and &quot;none&quot; initially)&amp;#10;    STIMULUS_DICT = STAIRCASE.next_stim&amp;#10;    trial_variables[&quot;displacement_cols&quot;] = STIMULUS_DICT[&quot;intensity&quot;]&amp;#10;    if trial_variables[&quot;orientation_degrees&quot;] &gt;= 90: # one staircase for symmetric oriented textures&amp;#10;        trial_variables[&quot;displacement_cols&quot;] = - trial_variables[&quot;displacement_cols&quot;]" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="# Update staircase&amp;#10;if trial_variables[&quot;state&quot;] == &quot;test&quot;:&amp;#10;    # staircase: positive == towards the upper texture parallely oriented to border&amp;#10;    if trial_variables[&quot;orientation_degrees&quot;] &lt; 90: # right upper texture more parallel to border; TODO: should be 45 instead of 90?&amp;#10;        response = 1 if (GetResponse.keys == &quot;right&quot;) else 0&amp;#10;    elif trial_variables[&quot;orientation_degrees&quot;] &gt;= 90: # left upper texture more parallel to border; TODO: should be 45 instead of 90?&amp;#10;        response = 1 if (GetResponse.keys == &quot;left&quot;) else 0&amp;#10;    STAIRCASE.update(stim=STIMULUS_DICT, outcome={&quot;response&quot;: response}) # variable &quot;staircase&quot; and &quot;stimulus_dict&quot; already selected at begin routine" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="UpdateVariablesAndStaircase" valType="code" updates="None" name="name"/>
      </CodeComponent>
      <CodeComponent name="DisplayStimulus" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="import {visual} from 'psychopy';&amp;#10;import * as np from 'numpy';&amp;#10;" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="# Pre-Compute stimuli&amp;#10;base_xys = {}&amp;#10;base_oris = {}&amp;#10;gabor_arrays = {}&amp;#10;for n_row_ in n_rows: # name n_row_ to avoid overwriting trial loop n_row condition&amp;#10;    # Pre-compute grid&amp;#10;    xs = np.linspace(-spacing * (n_col-1) / 2, spacing * (n_col-1) / 2, n_col)&amp;#10;    ys = np.linspace(0.0, spacing*(n_row_-1), n_row_)&amp;#10;    &amp;#10;    # Pre-compute locations in 3D: (2, n_row, n_col, 2) for [upper/lower, row, col, xy]&amp;#10;    xys_3d = np.zeros((2, n_row_, n_col, 2))&amp;#10;    for i, y in enumerate(ys):&amp;#10;        for j, x in enumerate(xs):&amp;#10;            xys_3d[0, i, j] = [x, y + vertical_seperation / 2]  # upper&amp;#10;            xys_3d[1, i, j] = [x, - y - vertical_seperation / 2]  # lower&amp;#10;    base_xys[n_row_] = xys_3d&amp;#10;    &amp;#10;    # Pre-compute orientations in 3D: (2, n_row, n_col) for [upper/lower, row, col]&amp;#10;    # upper right texture is 0° (vertically), upper left 90° (horizontally) oriented&amp;#10;    # lower right texture is 90° (horizontally), lower left 0° (vertically) oriented&amp;#10;    oris_3d = np.zeros((2, n_row_, n_col)) # all vertical&amp;#10;    oris_3d[0, :, :n_col // 2] = 90  # upper left horizontal&amp;#10;    oris_3d[1, :, n_col // 2:] = 90 # lower right horizontal&amp;#10;    base_oris[n_row_] = oris_3d&amp;#10;    &amp;#10;    # Flatten for ElementArrayStim&amp;#10;    xys_flat = xys_3d.reshape(-1, 2)  # Shape: (2*n_row*n_col, 2)&amp;#10;    oris_flat = oris_3d.flatten()     # Shape: (2*n_row*n_col,)&amp;#10;    &amp;#10;    # Pre-compute Gabor patches &amp;#10;    gabor_array = visual.ElementArrayStim(&amp;#10;        win=win,&amp;#10;        units='deg',&amp;#10;        nElements=2 * n_row_ * n_col,&amp;#10;        elementTex='sin',&amp;#10;        elementMask='gauss',&amp;#10;        xys=xys_flat,&amp;#10;        sizes=spacing,&amp;#10;        sfs=frequency,&amp;#10;        oris=oris_flat,&amp;#10;        contrs=mitchell_contrast&amp;#10;    )&amp;#10;    gabor_arrays[n_row_] = gabor_array" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="/* Syntax Error: Fix Python code */" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="win.color = [0, 0, 0] # keep grey background&amp;#10;&amp;#10;# randomize location of Gabor patch centers&amp;#10;jitter = rng.uniform(-jitter_amount, jitter_amount, &amp;#10;                           size=(2, trial_variables[&quot;n_row&quot;], n_col, 2))&amp;#10;xys_3D = base_xys[trial_variables[&quot;n_row&quot;]] + jitter&amp;#10;&amp;#10;# rotate to set orientation&amp;#10;oris_3D = base_oris[trial_variables[&quot;n_row&quot;]] + trial_variables[&quot;orientation_degrees&quot;]&amp;#10;&amp;#10;# displace upper texture horizontally&amp;#10;xys_3D[0, :, :, 0] += spacing * trial_variables[&quot;displacement_cols&quot;]&amp;#10;&amp;#10;# set eccentricity of texture&amp;#10;xys_3D[:, :, :, 0] += trial_variables[&quot;x_eccentricity_degrees&quot;] &amp;#10;xys_3D[:, :, :, 1] += trial_variables[&quot;y_eccentricity_degrees&quot;]&amp;#10;&amp;#10;# set and update stimulus&amp;#10;gabor_array = gabor_arrays[trial_variables[&quot;n_row&quot;]]&amp;#10;gabor_array.xys = xys_3D.reshape(-1, 2)&amp;#10;gabor_array.oris = oris_3D.flatten()" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="if frameN &lt; trial_variables[&quot;stimulus_frames&quot;]:&amp;#10;    gabor_array.draw()" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="DisplayStimulus" valType="code" updates="None" name="name"/>
      </CodeComponent>
      <CodeComponent name="DisplayMask" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="# Pre-compute scrambled stimulus as masks&amp;#10;mask_arrays = {}&amp;#10;for n_row_ in n_rows: # name n_row_ to avoid overwriting trial loop n_row condition&amp;#10;    # Pre-compute Gabor patches &amp;#10;    gabor_array = visual.ElementArrayStim(&amp;#10;        win=win,&amp;#10;        units='deg',&amp;#10;        nElements= 2 * n_row_ * n_col,&amp;#10;        elementTex='sin',&amp;#10;        elementMask='gauss',&amp;#10;        # maskParams={&quot;sd&quot;: 3}, # sets automatically sd = sigma if spacing == 6 sigma &amp;#10;        xys=base_xys[n_row_].reshape(-1, 2), &amp;#10;        sizes=spacing,&amp;#10;        sfs=frequency,&amp;#10;        oris=base_oris[n_row_].flatten(), # will be overwriten at begin routine&amp;#10;        contrs=mitchell_contrast&amp;#10;    )&amp;#10;    mask_arrays[n_row_] = gabor_array&amp;#10;" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="# Set mask&amp;#10;mask_array = mask_arrays[trial_variables[&quot;n_row&quot;]]&amp;#10;&amp;#10;# Copy stimulus locations to avoid confusing salient shifts after stimulus&amp;#10;xys_3D = base_xys[trial_variables[&quot;n_row&quot;]] + jitter&amp;#10;xys_3D[0, :, :, 0] += spacing * trial_variables[&quot;displacement_cols&quot;]&amp;#10;xys_3D[:, :, :, 0] += trial_variables[&quot;x_eccentricity_degrees&quot;]&amp;#10;xys_3D[:, :, :, 1] += trial_variables[&quot;y_eccentricity_degrees&quot;] &amp;#10;mask_array.xys = xys_3D.reshape(-1, 2)&amp;#10;&amp;#10;# But scramble orientation and thus texture&amp;#10;mask_array.oris = rng.uniform(0, 180, size=2 * trial_variables[&quot;n_row&quot;] * n_col)" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="if frameN &gt;= trial_variables[&quot;stimulus_frames&quot;]:&amp;#10;    mask_array.draw()" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="if ((frameN &gt;= duration_frames)) {&amp;#10;    noise_array.draw();&amp;#10;}&amp;#10;" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="win.color = [0, 0, 0] # keep grey background" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="DisplayMask" valType="code" updates="None" name="name"/>
      </CodeComponent>
      <PolygonComponent name="CentralExclusionZone_3" plugin="None">
        <Param val="center" valType="str" updates="constant" name="anchor"/>
        <Param val="rgb" valType="str" updates="constant" name="colorSpace"/>
        <Param val="1" valType="num" updates="constant" name="contrast"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="False" valType="code" updates="constant" name="draggable"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="[0, 0, 0]" valType="color" updates="constant" name="fillColor"/>
        <Param val="linear" valType="str" updates="constant" name="interpolate"/>
        <Param val="white" valType="color" updates="constant" name="lineColor"/>
        <Param val="2" valType="num" updates="constant" name="lineWidth"/>
        <Param val="4" valType="int" updates="constant" name="nVertices"/>
        <Param val="CentralExclusionZone_3" valType="code" updates="None" name="name"/>
        <Param val="" valType="num" updates="constant" name="opacity"/>
        <Param val="0" valType="num" updates="constant" name="ori"/>
        <Param val="(-x_eccentricity_degrees, -y_eccentricity_degrees)" valType="list" updates="set every repeat" name="pos"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="circle" valType="str" updates="None" name="shape"/>
        <Param val="(central_exclusion_width_degrees, central_exclusion_height_degrees)" valType="list" updates="constant" name="size"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="0.0" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="True" valType="bool" updates="None" name="syncScreenRefresh"/>
        <Param val="deg" valType="str" updates="None" name="units"/>
        <Param val="" valType="code" updates="None" name="validator"/>
        <Param val="" valType="list" updates="constant" name="vertices"/>
      </PolygonComponent>
      <PolygonComponent name="FixationShape_2" plugin="None">
        <Param val="center" valType="str" updates="constant" name="anchor"/>
        <Param val="rgb" valType="str" updates="constant" name="colorSpace"/>
        <Param val="1" valType="num" updates="constant" name="contrast"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="False" valType="code" updates="constant" name="draggable"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="white" valType="color" updates="constant" name="fillColor"/>
        <Param val="linear" valType="str" updates="constant" name="interpolate"/>
        <Param val="white" valType="color" updates="constant" name="lineColor"/>
        <Param val="1" valType="num" updates="constant" name="lineWidth"/>
        <Param val="4" valType="int" updates="constant" name="nVertices"/>
        <Param val="FixationShape_2" valType="code" updates="None" name="name"/>
        <Param val="" valType="num" updates="constant" name="opacity"/>
        <Param val="0" valType="num" updates="constant" name="ori"/>
        <Param val="(-x_eccentricity_degrees, -y_eccentricity_degrees)" valType="list" updates="set every repeat" name="pos"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="circle" valType="str" updates="None" name="shape"/>
        <Param val="(fixation_diameter, fixation_diameter)" valType="list" updates="constant" name="size"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="0.0" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="True" valType="bool" updates="None" name="syncScreenRefresh"/>
        <Param val="deg" valType="str" updates="None" name="units"/>
        <Param val="" valType="code" updates="None" name="validator"/>
        <Param val="" valType="list" updates="constant" name="vertices"/>
      </PolygonComponent>
      <KeyboardComponent name="GetResponse" plugin="None">
        <Param val="'left','right'" valType="list" updates="constant" name="allowedKeys"/>
        <Param val="" valType="str" updates="constant" name="correctAns"/>
        <Param val="" valType="str" updates="None" name="deviceLabel"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="True" valType="bool" updates="constant" name="discard previous"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="True" valType="bool" updates="constant" name="forceEndRoutine"/>
        <Param val="GetResponse" valType="code" updates="None" name="name"/>
        <Param val="press" valType="str" updates="constant" name="registerOn"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="0.0" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="last key" valType="str" updates="constant" name="store"/>
        <Param val="False" valType="bool" updates="constant" name="storeCorrect"/>
        <Param val="True" valType="bool" updates="constant" name="syncScreenRefresh"/>
      </KeyboardComponent>
      <CodeComponent name="SimulateResponse" plugin="None">
        <Param val="from scipy.stats import norm&amp;#10;&amp;#10;# Psychometrische Funktion (kumulative Normalverteilung)&amp;#10;def psychometric_function(x, mu=0, sigma=1):&amp;#10;    &quot;&quot;&quot;&amp;#10;    Berechnet die Wahrscheinlichkeit einer &quot;rechts&quot;-Antwort&amp;#10;    basierend auf einer kumulativen Normalverteilung.&amp;#10;    &amp;#10;    Parameter:&amp;#10;    x: Stimulus-Intensität oder -Position&amp;#10;    mu: Mittelwert (Point of Subjective Equality, PSE)&amp;#10;    sigma: Standardabweichung (Schwelle)&amp;#10;    &amp;#10;    Return: Wahrscheinlichkeit zwischen 0 und 1&amp;#10;    &quot;&quot;&quot;&amp;#10;    return norm.cdf(x, loc=mu, scale=sigma)&amp;#10;&amp;#10;# Simulierte Antwort basierend auf der psychometrischen Funktion&amp;#10;def simulate_response(stimulus_value, mu=0, sigma=1, left_key='left', right_key='right'):&amp;#10;    &quot;&quot;&quot;&amp;#10;    Simuliert einen Tastendruck basierend auf der psychometrischen Funktion.&amp;#10;    &amp;#10;    Parameter:&amp;#10;    stimulus_value: Der aktuelle Stimulus-Wert&amp;#10;    mu: PSE der psychometrischen Funktion&amp;#10;    sigma: Schwelle der psychometrischen Funktion&amp;#10;    left_key: Name der linken Taste&amp;#10;    right_key: Name der rechten Taste&amp;#10;    &amp;#10;    Return: Tastenname (left_key oder right_key)&amp;#10;    &quot;&quot;&quot;&amp;#10;    # Wahrscheinlichkeit für &quot;rechts&quot;&amp;#10;    p_right = psychometric_function(stimulus_value, mu, sigma)&amp;#10;    &amp;#10;    # Sample aus Bernoulli-Verteilung&amp;#10;    response = np.random.rand() &lt; p_right&amp;#10;    &amp;#10;    return right_key if response else left_key" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="PSE_monkey = 0 # columns&amp;#10;STD_monkey = 0.5 # columns&amp;#10;RT_monkey = 0.2 # s" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="if expInfo.get('monkey_mode', False):&amp;#10;    # simulate response if no key was pressed yet&amp;#10;    if not GetResponse.keys:&amp;#10;        # wait realistrically&amp;#10;        if t &gt; RT_monkey:  &amp;#10;            simulated_key = simulate_response(&amp;#10;                trial_variables[&quot;displacement_cols&quot;], &amp;#10;                mu=PSE_monkey, &amp;#10;                sigma=STD_monkey&amp;#10;            )&amp;#10;            &amp;#10;            GetResponse.keys = simulated_key&amp;#10;            GetResponse.rt = RT_monkey&amp;#10;            GetResponse.duration = None&amp;#10;            continueRoutine = False  # force routine end" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="SimulateResponse" valType="code" updates="None" name="name"/>
      </CodeComponent>
      <CodeComponent name="SaveTrialData" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="# save trial to trial data &amp;#10;# possibly redundant for non-staircase loops&amp;#10;trial_variables[&quot;response&quot;] = GetResponse.keys&amp;#10;for variable_name, variable_value in trial_variables.items():&amp;#10;    thisExp.addData(variable_name, variable_value) " valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="SaveTrialData" valType="code" updates="None" name="name"/>
      </CodeComponent>
    </Routine>
    <Routine name="Blank">
      <RoutineSettingsComponent name="Blank" plugin="None">
        <Param val="none" valType="str" updates="None" name="backgroundFit"/>
        <Param val="" valType="str" updates="None" name="backgroundImg"/>
        <Param val="$[0,0,0]" valType="color" updates="None" name="color"/>
        <Param val="rgb" valType="str" updates="None" name="colorSpace"/>
        <Param val="" valType="str" updates="constant" name="desc"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="False" valType="code" updates="None" name="forceNonSlip"/>
        <Param val="Blank" valType="code" updates="None" name="name"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="constant" name="skipIf"/>
        <Param val="frame N" valType="str" updates="None" name="stopType"/>
        <Param val="blank_frames" valType="code" updates="constant" name="stopVal"/>
        <Param val="False" valType="bool" updates="None" name="useWindowParams"/>
      </RoutineSettingsComponent>
      <CodeComponent name="SetBackground_4" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="psychoJS.window.color = [0, 0, 0];&amp;#10;" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="win.clearBuffer() &amp;#10;win.color = [0, 0, 0] # keep grey background" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="SetBackground_4" valType="code" updates="None" name="name"/>
      </CodeComponent>
      <CodeComponent name="CheckTimeAndTrialNumber" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="if ((state === &quot;train&quot;)) {&amp;#10;    if ((training_trials.thisN &gt;= nTrials_train)) {&amp;#10;        training_trials.finished = true;&amp;#10;    }&amp;#10;}&amp;#10;" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="# check clock&amp;#10;if track_time and trial_variables[&quot;state&quot;] == &quot;test&quot;:&amp;#10;    elapsed_time_s = time.time() - practice_start_time_s&amp;#10;    if elapsed_time_s &gt;= MAX_TIME_s:&amp;#10;        # log&amp;#10;        message = f&quot;Time limit reached: {elapsed_time_s/60:.1f} minutes elapsed after {testing_trials.thisN + 1} testing trials&quot;&amp;#10;        print(message)&amp;#10;        logging.info(message)&amp;#10;        logging.exp(message)&amp;#10;        &amp;#10;        # Add summary data&amp;#10;        thisExp.addData('time_limit_min', MAX_TIME_s / 60)&amp;#10;        thisExp.addData('tracked_time_min', elapsed_time_s / 60)&amp;#10;        thisExp.addData('time_limit_was_reached', True)&amp;#10;        &amp;#10;        # finish experiment&amp;#10;        testing_trials.finished = True&amp;#10;&amp;#10;# check trial number&amp;#10;if trial_variables[&quot;state&quot;] == &quot;train&quot;: # for some valid ExpInfo.yaml settings, there are more training conditions then nTrials_train&amp;#10;    if training_trials.thisN + 1 &gt;= nTrials_train: # + 1 since thisN starts at 0&amp;#10;        training_trials.finished = True&amp;#10;elif not track_time and trial_variables[&quot;state&quot;] == &quot;test&quot;: # if not track time, assure right number of trials despite of rounding issues&amp;#10;    if testing_trials.thisN + 1 &gt;= nTrials_test: # + 1 since thisN starts at 0&amp;#10;        testing_trials.finished = True" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="CheckTimeAndTrialNumber" valType="code" updates="None" name="name"/>
      </CodeComponent>
    </Routine>
    <Routine name="Wait">
      <RoutineSettingsComponent name="Wait" plugin="None">
        <Param val="none" valType="str" updates="None" name="backgroundFit"/>
        <Param val="" valType="str" updates="None" name="backgroundImg"/>
        <Param val="$[0,0,0]" valType="color" updates="None" name="color"/>
        <Param val="rgb" valType="str" updates="None" name="colorSpace"/>
        <Param val="" valType="str" updates="constant" name="desc"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="False" valType="code" updates="None" name="forceNonSlip"/>
        <Param val="Wait" valType="code" updates="None" name="name"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="constant" name="skipIf"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="False" valType="bool" updates="None" name="useWindowParams"/>
      </RoutineSettingsComponent>
      <CodeComponent name="SetBackground" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="/* Syntax Error: Fix Python code */" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="win.color = [0, 0, 0] # assure grey background" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="SetBackground" valType="code" updates="None" name="name"/>
      </CodeComponent>
      <CodeComponent name="PrintTrialNumber" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="TRIAL_COUNT = 0 # start counting with 1" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="console.log(`=== Trial ${(trials.thisN + 1)}/${trials.nTotal} ===`);&amp;#10;console.log(`Condition: ${condition}`);&amp;#10;console.log(`Stimulus: ${stimulus}`);&amp;#10;" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="TRIAL_COUNT += 1&amp;#10;print(f&quot;{state} trial {TRIAL_COUNT}&quot;) # print to note down and refind errors&amp;#10;thisExp.addData('global.thisN', TRIAL_COUNT) # save to compare with noted down global trial number" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="PrintTrialNumber" valType="code" updates="None" name="name"/>
      </CodeComponent>
      <KeyboardComponent name="AnyButton" plugin="None">
        <Param val="None" valType="list" updates="constant" name="allowedKeys"/>
        <Param val="" valType="str" updates="constant" name="correctAns"/>
        <Param val="" valType="str" updates="None" name="deviceLabel"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="True" valType="bool" updates="constant" name="discard previous"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="True" valType="bool" updates="constant" name="forceEndRoutine"/>
        <Param val="AnyButton" valType="code" updates="None" name="name"/>
        <Param val="press" valType="str" updates="constant" name="registerOn"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="frame N" valType="str" updates="None" name="startType"/>
        <Param val="10" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="last key" valType="str" updates="constant" name="store"/>
        <Param val="False" valType="bool" updates="constant" name="storeCorrect"/>
        <Param val="True" valType="bool" updates="constant" name="syncScreenRefresh"/>
      </KeyboardComponent>
      <PolygonComponent name="CentralExclusionZone_1" plugin="None">
        <Param val="center" valType="str" updates="constant" name="anchor"/>
        <Param val="rgb" valType="str" updates="constant" name="colorSpace"/>
        <Param val="1" valType="num" updates="constant" name="contrast"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="False" valType="code" updates="constant" name="draggable"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="[0,0,0]" valType="color" updates="constant" name="fillColor"/>
        <Param val="linear" valType="str" updates="constant" name="interpolate"/>
        <Param val="white" valType="color" updates="constant" name="lineColor"/>
        <Param val="2" valType="num" updates="constant" name="lineWidth"/>
        <Param val="4" valType="int" updates="constant" name="nVertices"/>
        <Param val="CentralExclusionZone_1" valType="code" updates="None" name="name"/>
        <Param val="" valType="num" updates="constant" name="opacity"/>
        <Param val="0" valType="num" updates="constant" name="ori"/>
        <Param val="(-x_eccentricity_degrees, -y_eccentricity_degrees)" valType="list" updates="set every repeat" name="pos"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="circle" valType="str" updates="None" name="shape"/>
        <Param val="(central_exclusion_width_degrees, central_exclusion_height_degrees)" valType="list" updates="constant" name="size"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="0" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="True" valType="bool" updates="None" name="syncScreenRefresh"/>
        <Param val="deg" valType="str" updates="None" name="units"/>
        <Param val="" valType="code" updates="None" name="validator"/>
        <Param val="" valType="list" updates="constant" name="vertices"/>
      </PolygonComponent>
      <TextComponent name="PressAnyButtonForNextTrialText" plugin="None">
        <Param val="white" valType="color" updates="constant" name="color"/>
        <Param val="rgb" valType="str" updates="constant" name="colorSpace"/>
        <Param val="1" valType="num" updates="constant" name="contrast"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="False" valType="code" updates="constant" name="draggable"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="None" valType="str" updates="constant" name="flip"/>
        <Param val="Arial" valType="str" updates="constant" name="font"/>
        <Param val="LTR" valType="str" updates="None" name="languageStyle"/>
        <Param val="1.0" valType="num" updates="constant" name="letterHeight"/>
        <Param val="PressAnyButtonForNextTrialText" valType="code" updates="None" name="name"/>
        <Param val="" valType="num" updates="constant" name="opacity"/>
        <Param val="0" valType="num" updates="constant" name="ori"/>
        <Param val="(-x_eccentricity_degrees, -y_eccentricity_degrees)" valType="list" updates="set every repeat" name="pos"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="0" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="True" valType="bool" updates="None" name="syncScreenRefresh"/>
        <Param val="$&quot;Press any button\nfor %d. trial&quot; % (TRIAL_COUNT)" valType="str" updates="set every repeat" name="text"/>
        <Param val="deg" valType="str" updates="None" name="units"/>
        <Param val="" valType="code" updates="None" name="validator"/>
        <Param val="" valType="num" updates="constant" name="wrapWidth"/>
      </TextComponent>
      <CodeComponent name="SimulateButtonPress" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="if expInfo.get('monkey_mode', False):&amp;#10;    # simulate response if no key was pressed yet&amp;#10;    if not AnyButton.keys:&amp;#10;        if t &gt; RT_monkey:&amp;#10;            AnyButton.keys = &quot;enter&quot;&amp;#10;            AnyButton.rt = RT_monkey&amp;#10;            AnyButton.duration = None&amp;#10;            continueRoutine = False " valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="SimulateButtonPress" valType="code" updates="None" name="name"/>
      </CodeComponent>
    </Routine>
    <Routine name="Dialogue">
      <RoutineSettingsComponent name="Dialogue" plugin="None">
        <Param val="none" valType="str" updates="None" name="backgroundFit"/>
        <Param val="" valType="str" updates="None" name="backgroundImg"/>
        <Param val="$[0,0,0]" valType="color" updates="None" name="color"/>
        <Param val="rgb" valType="str" updates="None" name="colorSpace"/>
        <Param val="" valType="str" updates="constant" name="desc"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="False" valType="code" updates="None" name="forceNonSlip"/>
        <Param val="Dialogue" valType="code" updates="None" name="name"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="constant" name="skipIf"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="False" valType="bool" updates="None" name="useWindowParams"/>
      </RoutineSettingsComponent>
      <TextComponent name="RepeatOrContinueText" plugin="None">
        <Param val="white" valType="color" updates="constant" name="color"/>
        <Param val="rgb" valType="str" updates="constant" name="colorSpace"/>
        <Param val="1" valType="num" updates="constant" name="contrast"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="False" valType="code" updates="constant" name="draggable"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="None" valType="str" updates="constant" name="flip"/>
        <Param val="Arial" valType="str" updates="constant" name="font"/>
        <Param val="LTR" valType="str" updates="None" name="languageStyle"/>
        <Param val="1" valType="num" updates="constant" name="letterHeight"/>
        <Param val="RepeatOrContinueText" valType="code" updates="None" name="name"/>
        <Param val="" valType="num" updates="constant" name="opacity"/>
        <Param val="0" valType="num" updates="constant" name="ori"/>
        <Param val="(0, 0)" valType="list" updates="constant" name="pos"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="0.2" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="True" valType="bool" updates="None" name="syncScreenRefresh"/>
        <Param val="To repeat, press &quot;r&quot;. &amp;#10;&amp;#10;To continue, press &quot;c&quot;." valType="str" updates="constant" name="text"/>
        <Param val="deg" valType="str" updates="None" name="units"/>
        <Param val="" valType="code" updates="None" name="validator"/>
        <Param val="" valType="num" updates="constant" name="wrapWidth"/>
      </TextComponent>
      <KeyboardComponent name="RepeatOrContinueButton" plugin="None">
        <Param val="'r','c'" valType="list" updates="constant" name="allowedKeys"/>
        <Param val="" valType="str" updates="constant" name="correctAns"/>
        <Param val="" valType="str" updates="None" name="deviceLabel"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="True" valType="bool" updates="constant" name="discard previous"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="True" valType="bool" updates="constant" name="forceEndRoutine"/>
        <Param val="RepeatOrContinueButton" valType="code" updates="None" name="name"/>
        <Param val="press" valType="str" updates="constant" name="registerOn"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="0.2" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="last key" valType="str" updates="constant" name="store"/>
        <Param val="False" valType="bool" updates="constant" name="storeCorrect"/>
        <Param val="True" valType="bool" updates="constant" name="syncScreenRefresh"/>
      </KeyboardComponent>
      <CodeComponent name="FinishLoop" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="if RepeatOrContinueButton.keys == 'c':&amp;#10;    if trial_variables[&quot;state&quot;] == 'instruct': # stop instructions&amp;#10;        instruction.finished = True&amp;#10;    elif trial_variables[&quot;state&quot;] == 'train': # stop training / practice&amp;#10;        training.finished = True" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="FinishLoop" valType="code" updates="None" name="name"/>
      </CodeComponent>
    </Routine>
    <Routine name="Break">
      <RoutineSettingsComponent name="Break" plugin="None">
        <Param val="none" valType="str" updates="None" name="backgroundFit"/>
        <Param val="" valType="str" updates="None" name="backgroundImg"/>
        <Param val="$[0,0,0]" valType="color" updates="None" name="color"/>
        <Param val="rgb" valType="str" updates="None" name="colorSpace"/>
        <Param val="" valType="str" updates="constant" name="desc"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="False" valType="code" updates="None" name="forceNonSlip"/>
        <Param val="Break" valType="code" updates="None" name="name"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="constant" name="skipIf"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="False" valType="bool" updates="None" name="useWindowParams"/>
      </RoutineSettingsComponent>
      <TextComponent name="TakeABreakText" plugin="None">
        <Param val="white" valType="color" updates="constant" name="color"/>
        <Param val="rgb" valType="str" updates="constant" name="colorSpace"/>
        <Param val="1" valType="num" updates="constant" name="contrast"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="False" valType="code" updates="constant" name="draggable"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="None" valType="str" updates="constant" name="flip"/>
        <Param val="Arial" valType="str" updates="constant" name="font"/>
        <Param val="LTR" valType="str" updates="None" name="languageStyle"/>
        <Param val="1.0" valType="num" updates="constant" name="letterHeight"/>
        <Param val="TakeABreakText" valType="code" updates="None" name="name"/>
        <Param val="" valType="num" updates="constant" name="opacity"/>
        <Param val="0" valType="num" updates="constant" name="ori"/>
        <Param val="(0, 0)" valType="list" updates="constant" name="pos"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="0.2" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="True" valType="bool" updates="None" name="syncScreenRefresh"/>
        <Param val="Take a break!" valType="str" updates="constant" name="text"/>
        <Param val="deg" valType="str" updates="None" name="units"/>
        <Param val="" valType="code" updates="None" name="validator"/>
        <Param val="" valType="num" updates="constant" name="wrapWidth"/>
      </TextComponent>
      <KeyboardComponent name="AnyButton_2" plugin="None">
        <Param val="None" valType="list" updates="constant" name="allowedKeys"/>
        <Param val="" valType="str" updates="constant" name="correctAns"/>
        <Param val="" valType="str" updates="None" name="deviceLabel"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="True" valType="bool" updates="constant" name="discard previous"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="True" valType="bool" updates="constant" name="forceEndRoutine"/>
        <Param val="AnyButton_2" valType="code" updates="None" name="name"/>
        <Param val="press" valType="str" updates="constant" name="registerOn"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="0.2" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="last key" valType="str" updates="constant" name="store"/>
        <Param val="False" valType="bool" updates="constant" name="storeCorrect"/>
        <Param val="True" valType="bool" updates="constant" name="syncScreenRefresh"/>
      </KeyboardComponent>
    </Routine>
    <Routine name="QandASession">
      <RoutineSettingsComponent name="QandASession" plugin="None">
        <Param val="none" valType="str" updates="None" name="backgroundFit"/>
        <Param val="" valType="str" updates="None" name="backgroundImg"/>
        <Param val="$[0,0,0]" valType="color" updates="None" name="color"/>
        <Param val="rgb" valType="str" updates="None" name="colorSpace"/>
        <Param val="" valType="str" updates="constant" name="desc"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="False" valType="code" updates="None" name="forceNonSlip"/>
        <Param val="QandASession" valType="code" updates="None" name="name"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="constant" name="skipIf"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="False" valType="bool" updates="None" name="useWindowParams"/>
      </RoutineSettingsComponent>
      <CodeComponent name="ShowMouse" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="win.mouseVisible = True" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="win.mouseVisible = False" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="ShowMouse" valType="code" updates="None" name="name"/>
      </CodeComponent>
      <FormComponent name="QandAForm" plugin="None">
        <Param val="rows" valType="str" updates="constant" name="Data Format"/>
        <Param val="Noto Sans" valType="str" updates="constant" name="Font"/>
        <Param val="0.05" valType="num" updates="constant" name="Item Padding"/>
        <Param val="C:/Users/kai.rothe/Documents/V1SH_experiment/experiment/QandA.csv" valType="file" updates="constant" name="Items"/>
        <Param val="False" valType="bool" updates="constant" name="Randomize"/>
        <Param val="dark" valType="str" updates="constant" name="Style"/>
        <Param val="0.03" valType="num" updates="constant" name="Text Height"/>
        <Param val="" valType="color" updates="constant" name="borderColor"/>
        <Param val="rgb" valType="str" updates="constant" name="colorSpace"/>
        <Param val="1" valType="num" updates="constant" name="contrast"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="" valType="color" updates="constant" name="fillColor"/>
        <Param val="white" valType="color" updates="constant" name="itemColor"/>
        <Param val="red" valType="color" updates="constant" name="markerColor"/>
        <Param val="QandAForm" valType="code" updates="None" name="name"/>
        <Param val="" valType="num" updates="constant" name="opacity"/>
        <Param val="(-0.3, 0)" valType="list" updates="constant" name="pos"/>
        <Param val="white" valType="color" updates="constant" name="responseColor"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="(1.0, 0.9)" valType="list" updates="constant" name="size"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="0.1" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="True" valType="bool" updates="None" name="syncScreenRefresh"/>
        <Param val="" valType="code" updates="None" name="validator"/>
      </FormComponent>
      <ButtonComponent name="FinishButton" plugin="None">
        <Param val="center" valType="str" updates="constant" name="anchor"/>
        <Param val="False" valType="bool" updates="constant" name="bold"/>
        <Param val="red" valType="color" updates="constant" name="borderColor"/>
        <Param val="1" valType="num" updates="constant" name="borderWidth"/>
        <Param val="" valType="extendedCode" updates="constant" name="callback"/>
        <Param val="white" valType="color" updates="constant" name="color"/>
        <Param val="rgb" valType="str" updates="constant" name="colorSpace"/>
        <Param val="1" valType="num" updates="constant" name="contrast"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="red" valType="color" updates="constant" name="fillColor"/>
        <Param val="Arial" valType="str" updates="constant" name="font"/>
        <Param val="True" valType="bool" updates="constant" name="forceEndRoutine"/>
        <Param val="False" valType="bool" updates="constant" name="italic"/>
        <Param val="1" valType="num" updates="constant" name="letterHeight"/>
        <Param val="FinishButton" valType="code" updates="None" name="name"/>
        <Param val="True" valType="bool" updates="constant" name="oncePerClick"/>
        <Param val="" valType="num" updates="constant" name="opacity"/>
        <Param val="0" valType="num" updates="constant" name="ori"/>
        <Param val="" valType="num" updates="constant" name="padding"/>
        <Param val="(10, 0)" valType="list" updates="constant" name="pos"/>
        <Param val="every click" valType="str" updates="None" name="save"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="(7, 8)" valType="list" updates="constant" name="size"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="10" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="True" valType="bool" updates="None" name="syncScreenRefresh"/>
        <Param val="Click HERE to finish" valType="str" updates="constant" name="text"/>
        <Param val="button onset" valType="str" updates="constant" name="timeRelativeTo"/>
        <Param val="deg" valType="str" updates="None" name="units"/>
        <Param val="" valType="code" updates="None" name="validator"/>
      </ButtonComponent>
    </Routine>
    <Routine name="SaveData">
      <RoutineSettingsComponent name="SaveData" plugin="None">
        <Param val="none" valType="str" updates="None" name="backgroundFit"/>
        <Param val="" valType="str" updates="None" name="backgroundImg"/>
        <Param val="$[0,0,0]" valType="color" updates="None" name="color"/>
        <Param val="rgb" valType="str" updates="None" name="colorSpace"/>
        <Param val="" valType="str" updates="constant" name="desc"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="False" valType="code" updates="None" name="forceNonSlip"/>
        <Param val="SaveData" valType="code" updates="None" name="name"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="constant" name="skipIf"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="False" valType="bool" updates="None" name="useWindowParams"/>
      </RoutineSettingsComponent>
      <CodeComponent name="SaveAdditionalData" plugin="None">
        <Param val="" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="import * as atexit from 'atexit';&amp;#10;import * as shutil from 'shutil';&amp;#10;import * as os from 'os';&amp;#10;import {datetime} from 'datetime';&amp;#10;" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="def save_experiment_files_robust():&amp;#10;    &quot;&quot;&quot;Save experiment files using PsychoPy's auto-generated filename&quot;&quot;&quot;&amp;#10;    try:&amp;#10;        # 'filename' is auto-generated by Builder from Experiment Settings&amp;#10;        # It's already the full path without extension&amp;#10;        # E.g., 'data/participant001_myExperiment_2025-11-20_1435'&amp;#10;        dataDir = os.path.dirname(filename)&amp;#10;        baseName = os.path.basename(filename) &amp;#10;        &amp;#10;        # Files to save: (relative_path, original_filename, extension)&amp;#10;        files_to_save = [&amp;#10;            (&quot;&quot;, expName + '.psyexp', '.psyexp'),&amp;#10;            (&quot;..&quot;, &quot;instructions.csv&quot;, '.csv'),&amp;#10;            (&quot;..&quot;, &quot;ExpInfo.yaml&quot;, '.yaml'),&amp;#10;            (&quot;..&quot;, &quot;QandA.csv&quot;, &quot;.csv&quot;)&amp;#10;        ]&amp;#10;        &amp;#10;        for relative_path, source_filename, ext in files_to_save:&amp;#10;            # Build the full source path correctly&amp;#10;            if relative_path:&amp;#10;                filepath = os.path.join(_thisDir, relative_path, source_filename)&amp;#10;            else:&amp;#10;                filepath = os.path.join(_thisDir, source_filename)&amp;#10;            &amp;#10;            # Normalize the path to handle &quot;..&quot; properly&amp;#10;            filepath = os.path.normpath(filepath)&amp;#10;            &amp;#10;            print(f&quot;Looking for: {filepath}&quot;)  # Debug print&amp;#10;            &amp;#10;            if os.path.exists(filepath):&amp;#10;                # Get modification date&amp;#10;                modDate = datetime.fromtimestamp(&amp;#10;                    os.path.getmtime(filepath)&amp;#10;                ).strftime('%Y-%m-%d_%H%M')&amp;#10;                &amp;#10;                # Extract just the name without extension for renaming&amp;#10;                source_base = os.path.splitext(source_filename)[0]&amp;#10;                &amp;#10;                # Create destination filename&amp;#10;                destFilename = f&quot;{source_base}_mod-{modDate}{ext}&quot;&amp;#10;                destPath = os.path.join(dataDir, destFilename)&amp;#10;                &amp;#10;                shutil.copy2(filepath, destPath)&amp;#10;                print(f&quot;Saved: {destFilename}&quot;)&amp;#10;            else:&amp;#10;                print(f&quot;File not found: {filepath}&quot;)  # Debug print&amp;#10;                &amp;#10;    except Exception as e:&amp;#10;        logging.error(f'Could not save experiment files: {e}')&amp;#10;        print(f&quot;Error in save_experiment_files_robust: {e}&quot;)  # Additional debug&amp;#10;&amp;#10;def get_psychopy_info():&amp;#10;    # Function to dynamically retrieve PsychoPy information&amp;#10;    psychopy_info = {&amp;#10;        &quot;Hardware&quot;: {&amp;#10;            &quot;Display&quot;: {&amp;#10;                &quot;Type&quot;: win.monitor.name,&amp;#10;                &quot;MeanLuminance_cd/m2&quot;: expInfo['mean_luminance_cdpm2'],&amp;#10;                &quot;RefreshRate_Hz&quot;: expInfo['frameRate'],&amp;#10;                &quot;ViewingDistance_cm&quot;: expInfo[&quot;viewing_distance_cm&quot;],&amp;#10;                &quot;GammaCorrection&quot;: win.monitor.getGammaGrid() is not None&amp;#10;            },&amp;#10;            &quot;EyeTracker&quot;: {&amp;#10;                &quot;Usage&quot;: False # TODO: Replace with actual eye tracker check&amp;#10;            }&amp;#10;        }&amp;#10;    }&amp;#10;    return psychopy_info&amp;#10;&amp;#10;def compare_and_update(yaml_file, psychopy_info):&amp;#10;    # Compare psychopy hardware with manual ExpInfo YAML file&amp;#10;    # and update values if necessary&amp;#10;    updated = False&amp;#10;    for section, values in psychopy_info.items():&amp;#10;        if section in yaml_file:&amp;#10;            for key, value in values.items():&amp;#10;                if key in yaml_file[section] and yaml_file[section][key] != value:&amp;#10;                    yaml_file[section][key] = value&amp;#10;                    if key != &quot;RandomSeed&quot;:&amp;#10;                        updated = True&amp;#10;                    &amp;#10;        else:&amp;#10;            yaml_file[section] = values&amp;#10;            updated = True&amp;#10;    &amp;#10;    if updated:  &amp;#10;        print(&quot;Warning: ExpInfo file modified.&quot;)&amp;#10;        logging.warning(&quot;ExpInfo file modified.&quot;)&amp;#10;&amp;#10;    return updated&amp;#10;&amp;#10;# Save staircase updates&amp;#10;def eval_and_save_staircase():&amp;#10;    if not staircases: &amp;#10;        print(&quot;Warning: eval_and_save_staircase could not be executed (no staircases initialized)&quot;)&amp;#10;        logging.warning(&quot;eval_and_save_staircase could not be executed (no staircases initialized)&quot;)&amp;#10;        return &amp;#10;    else: &amp;#10;        try:&amp;#10;            for label, staircase_ in staircases.items(): # name &quot;staircase_&quot; to avoid overwriting global STAIRCASE variable&amp;#10;                # 1. Print out and save parameters&amp;#10;                params_dict =  staircase_.param_estimate&amp;#10;                mean, std, lapse_rate = params_dict[&quot;mean&quot;], params_dict[&quot;sd&quot;], params_dict[&quot;lapse_rate&quot;]&amp;#10;                print(f&quot;Parameter of staircase {label}:\n   mean = {mean}\n   std = {std}\n   lapse_rate = {lapse_rate}&quot;)&amp;#10;                &amp;#10;                # 'filename' is auto-generated by Builder from Experiment Settings&amp;#10;                # It's already the full path without extension&amp;#10;                # E.g., 'data/participant001_myExperiment_2025-11-20_1435'&amp;#10;                dataDir = os.path.dirname(filename)&amp;#10;                results_name = &quot;staircase_params&quot; + &quot;_&quot; + label + &quot;.json&quot;&amp;#10;                save_as = os.path.join(dataDir, results_name)&amp;#10;                with open(save_as, 'w') as f:&amp;#10;                    json.dump(params_dict, f, indent=2)&amp;#10;                print(f&quot;Saved: {results_name}&quot;)&amp;#10;                &amp;#10;                # 2. Save complete staircase for reloading e.g. detailed analysis&amp;#10;                staircase_name = &quot;questplus_staircase&quot; + &quot;_&quot; + label + &quot;.json&quot;&amp;#10;                save_as = os.path.join(dataDir, staircase_name)&amp;#10;                staircase_json_dump = staircase_.to_json() # string&amp;#10;                with open(save_as, 'w') as f:&amp;#10;                    f.write(staircase_json_dump)&amp;#10;                print(f&quot;Saved: {staircase_name}&quot;)&amp;#10;                &amp;#10;                # 3. Save marginal posteriors&amp;#10;                posterior_name = &quot;questplus_posterior&quot; + &quot;_&quot; + label + &quot;.pkl&quot;&amp;#10;                save_as = os.path.join(dataDir, posterior_name)&amp;#10;                posterior_dict = staircase_.marginal_posterior&amp;#10;                with open(save_as, 'wb') as f:&amp;#10;                    pickle.dump(posterior_dict, f)&amp;#10;                print(f&quot;Saved: {posterior_name}&quot;)&amp;#10;            &amp;#10;        except Exception as e:&amp;#10;            raise(e)&amp;#10;            # logging.error(f'Could not save quest eval: {e}')&amp;#10;            # print(f&quot;Error in eval_and_save_staircase: {e}&quot;)  # Additional debug&amp;#10;&amp;#10;# Update ExpInfo with PsychoPy hardware info&amp;#10;psychopy_info = get_psychopy_info()&amp;#10;compare_and_update(ExpInfo, psychopy_info)&amp;#10;&amp;#10;# Save immediately at start&amp;#10;save_experiment_files_robust()&amp;#10;&amp;#10;# Save at the end, or if computer fails / experiment is stopped by &quot;esc&quot;&amp;#10;atexit.register(save_experiment_files_robust)&amp;#10;atexit.register(eval_and_save_staircase)" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="SaveAdditionalData" valType="code" updates="None" name="name"/>
      </CodeComponent>
    </Routine>
    <Routine name="End">
      <RoutineSettingsComponent name="End" plugin="None">
        <Param val="none" valType="str" updates="None" name="backgroundFit"/>
        <Param val="" valType="str" updates="None" name="backgroundImg"/>
        <Param val="$[0,0,0]" valType="color" updates="None" name="color"/>
        <Param val="rgb" valType="str" updates="None" name="colorSpace"/>
        <Param val="" valType="str" updates="constant" name="desc"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="False" valType="code" updates="None" name="forceNonSlip"/>
        <Param val="End" valType="code" updates="None" name="name"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="constant" name="skipIf"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="False" valType="bool" updates="None" name="useWindowParams"/>
      </RoutineSettingsComponent>
      <TextComponent name="ThankYou" plugin="None">
        <Param val="white" valType="color" updates="constant" name="color"/>
        <Param val="rgb" valType="str" updates="constant" name="colorSpace"/>
        <Param val="1" valType="num" updates="constant" name="contrast"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="False" valType="code" updates="constant" name="draggable"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="None" valType="str" updates="constant" name="flip"/>
        <Param val="Arial" valType="str" updates="constant" name="font"/>
        <Param val="LTR" valType="str" updates="None" name="languageStyle"/>
        <Param val="1.0" valType="num" updates="constant" name="letterHeight"/>
        <Param val="ThankYou" valType="code" updates="None" name="name"/>
        <Param val="" valType="num" updates="constant" name="opacity"/>
        <Param val="0" valType="num" updates="constant" name="ori"/>
        <Param val="(0, 0)" valType="list" updates="constant" name="pos"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="None" name="startEstim"/>
        <Param val="time (s)" valType="str" updates="None" name="startType"/>
        <Param val="0.1" valType="code" updates="None" name="startVal"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="5.0" valType="code" updates="constant" name="stopVal"/>
        <Param val="True" valType="bool" updates="None" name="syncScreenRefresh"/>
        <Param val="Thank you!" valType="str" updates="constant" name="text"/>
        <Param val="deg" valType="str" updates="None" name="units"/>
        <Param val="" valType="code" updates="None" name="validator"/>
        <Param val="" valType="num" updates="constant" name="wrapWidth"/>
      </TextComponent>
    </Routine>
    <Routine name="StartTimer">
      <RoutineSettingsComponent name="StartTimer" plugin="None">
        <Param val="none" valType="str" updates="None" name="backgroundFit"/>
        <Param val="" valType="str" updates="None" name="backgroundImg"/>
        <Param val="$[0,0,0]" valType="color" updates="None" name="color"/>
        <Param val="rgb" valType="str" updates="None" name="colorSpace"/>
        <Param val="" valType="str" updates="constant" name="desc"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="" valType="code" updates="None" name="durationEstim"/>
        <Param val="False" valType="code" updates="None" name="forceNonSlip"/>
        <Param val="StartTimer" valType="code" updates="None" name="name"/>
        <Param val="True" valType="bool" updates="None" name="saveStartStop"/>
        <Param val="" valType="code" updates="constant" name="skipIf"/>
        <Param val="duration (s)" valType="str" updates="None" name="stopType"/>
        <Param val="" valType="code" updates="constant" name="stopVal"/>
        <Param val="False" valType="bool" updates="None" name="useWindowParams"/>
      </RoutineSettingsComponent>
      <CodeComponent name="Timer" plugin="None">
        <Param val="import time" valType="extendedCode" updates="constant" name="Before Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Before JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="Begin JS Routine"/>
        <Param val="# Start tracking time&amp;#10;if track_time:&amp;#10;    practice_start_time_s = time.time()&amp;#10;    &amp;#10;    # log&amp;#10;    message = f&quot;Timer started at {practice_start_time_s / 60} minutes&quot;&amp;#10;    print(message)&amp;#10;    logging.info(message)&amp;#10;    logging.exp(message)&amp;#10;    &amp;#10;    # Save summary data&amp;#10;    thisExp.addData(&quot;practice_start_time_min&quot;, practice_start_time_s / 60)&amp;#10;    thisExp.addData(&quot;time_was_tracked&quot;, True)&amp;#10;    thisExp.addData('time_limit_was_reached', False)" valType="extendedCode" updates="constant" name="Begin Routine"/>
        <Param val="Py" valType="str" updates="None" name="Code Type"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="Each JS Frame"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Experiment"/>
        <Param val="" valType="extendedCode" updates="constant" name="End JS Routine"/>
        <Param val="" valType="extendedCode" updates="constant" name="End Routine"/>
        <Param val="False" valType="bool" updates="None" name="disabled"/>
        <Param val="Timer" valType="code" updates="None" name="name"/>
      </CodeComponent>
    </Routine>
  </Routines>
  <Flow>
    <Routine name="Preparation"/>
    <LoopInitiator loopType="TrialHandler" name="instruction">
      <Param name="Selected rows" updates="None" val="" valType="str"/>
      <Param name="conditions" updates="None" val="None" valType="str"/>
      <Param name="conditionsFile" updates="None" val="" valType="file"/>
      <Param name="endPoints" updates="None" val="[0, 1]" valType="num"/>
      <Param name="isTrials" updates="None" val="False" valType="bool"/>
      <Param name="loopType" updates="None" val="sequential" valType="str"/>
      <Param name="nReps" updates="None" val="999 if expInfo['skip_instructions'] == False else 0" valType="num"/>
      <Param name="name" updates="None" val="instruction" valType="code"/>
      <Param name="random seed" updates="None" val="" valType="code"/>
    </LoopInitiator>
    <LoopInitiator loopType="TrialHandler" name="instruction_trials">
      <Param name="Selected rows" updates="None" val="" valType="str"/>
      <Param name="conditions" updates="None" val="[OrderedDict([('n_row', np.int64(12)), ('displacement_cols', np.float64(2.0)), ('orientation_degrees', np.int64(0)), ('stimulus_duration_s', np.float64(120.0)), ('instruction', 'First a circle in the center is shown. Your task is to look at that circle and keep your gaze fixed on it. Keep your gaze fixed to the center for the whole time. Therewhile you are shown an image with textures. The upper texture has a boundary and the lower texture has a boundary as well. Your task is to decide weather the UPPER boundary is more to the left or the right of the lower texture. If you think that the UPPER boundary is more to the LEFT: press the &quot;left&quot; button. If you think that the UPPER boundary is more to the RIGHT: press the &quot;right&quot; button. Let subject ask questions.'), ('session', np.int64(0)), ('stimulus_frames', np.int64(7207)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'instruct')]), OrderedDict([('n_row', np.int64(12)), ('displacement_cols', np.float64(-2.0)), ('orientation_degrees', np.int64(90)), ('stimulus_duration_s', np.float64(120.0)), ('instruction', ' '), ('session', np.int64(0)), ('stimulus_frames', np.int64(7188)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'instruct')]), OrderedDict([('n_row', np.int64(12)), ('displacement_cols', np.float64(1.0)), ('orientation_degrees', np.int64(90)), ('stimulus_duration_s', np.float64(120.0)), ('instruction', &quot;Don't forget to always keep your gaze fixed to the center for the whole time. Use the circle to look at the center again.&quot;), ('session', np.int64(0)), ('stimulus_frames', np.int64(7195)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'instruct')]), OrderedDict([('n_row', np.int64(12)), ('displacement_cols', np.float64(-1.0)), ('orientation_degrees', np.int64(0)), ('stimulus_duration_s', np.float64(120.0)), ('instruction', None), ('session', np.int64(0)), ('stimulus_frames', np.int64(7188)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'instruct')]), OrderedDict([('n_row', np.int64(1)), ('displacement_cols', np.float64(2.0)), ('orientation_degrees', np.int64(0)), ('stimulus_duration_s', np.float64(120.0)), ('instruction', 'The texture can have different sizes. Your task is still to decide if the UPPER texture boundary is to the left or right of the lower texture boundary. Let subject ask questions.'), ('session', np.int64(0)), ('stimulus_frames', np.int64(7201)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'instruct')]), OrderedDict([('n_row', np.int64(1)), ('displacement_cols', np.float64(-2.0)), ('orientation_degrees', np.int64(90)), ('stimulus_duration_s', np.float64(120.0)), ('instruction', None), ('session', np.int64(0)), ('stimulus_frames', np.int64(7197)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'instruct')]), OrderedDict([('n_row', np.int64(12)), ('displacement_cols', np.float64(0.5)), ('orientation_degrees', np.int64(0)), ('stimulus_duration_s', np.float64(120.0)), ('instruction', &quot;If you are unsure: guess. But don't give up - use any hint or clue or feeling you might have. Let subject ask questions.&quot;), ('session', np.int64(0)), ('stimulus_frames', np.int64(7204)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'instruct')]), OrderedDict([('n_row', np.int64(1)), ('displacement_cols', np.float64(0.5)), ('orientation_degrees', np.int64(90)), ('stimulus_duration_s', np.float64(120.0)), ('instruction', ' '), ('session', np.int64(0)), ('stimulus_frames', np.int64(7190)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'instruct')]), OrderedDict([('n_row', np.int64(12)), ('displacement_cols', np.float64(-1.0)), ('orientation_degrees', np.int64(0)), ('stimulus_duration_s', np.float64(1.0)), ('instruction', &quot;The image is only shown shortly. This might make it more difficult to locate and compare the boundaries. But don't give up - use any hint or clue or feeling you have. Let subject ask questions.&quot;), ('session', np.int64(0)), ('stimulus_frames', np.int64(60)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'instruct')]), OrderedDict([('n_row', np.int64(1)), ('displacement_cols', np.float64(0.5)), ('orientation_degrees', np.int64(0)), ('stimulus_duration_s', np.float64(1.0)), ('instruction', None), ('session', np.int64(0)), ('stimulus_frames', np.int64(60)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'instruct')]), OrderedDict([('n_row', np.int64(1)), ('displacement_cols', np.float64(1.0)), ('orientation_degrees', np.int64(90)), ('stimulus_duration_s', np.float64(1.0)), ('instruction', &quot;The task might get repetitive. But take it like a competition or video game. Don't give up.&quot;), ('session', np.int64(0)), ('stimulus_frames', np.int64(60)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'instruct')]), OrderedDict([('n_row', np.int64(12)), ('displacement_cols', np.float64(-0.5)), ('orientation_degrees', np.int64(90)), ('stimulus_duration_s', np.float64(0.15)), ('instruction', ' '), ('session', np.int64(0)), ('stimulus_frames', np.int64(9)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'instruct')]), OrderedDict([('n_row', np.int64(1)), ('displacement_cols', np.float64(-0.5)), ('orientation_degrees', np.int64(0)), ('stimulus_duration_s', np.float64(0.15)), ('instruction', 'Let subject ask questions. Repeat if necessary.'), ('session', np.int64(0)), ('stimulus_frames', np.int64(9)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'instruct')])]" valType="str"/>
      <Param name="conditionsFile" updates="None" val="conditions_temp_instruct.csv" valType="file"/>
      <Param name="endPoints" updates="None" val="[0, 1]" valType="num"/>
      <Param name="isTrials" updates="None" val="True" valType="bool"/>
      <Param name="loopType" updates="None" val="sequential" valType="str"/>
      <Param name="nReps" updates="None" val="1" valType="num"/>
      <Param name="name" updates="None" val="instruction_trials" valType="code"/>
      <Param name="random seed" updates="None" val="" valType="code"/>
    </LoopInitiator>
    <Routine name="Wait"/>
    <Routine name="Fixation"/>
    <Routine name="Stimulus"/>
    <Routine name="Blank"/>
    <LoopTerminator name="instruction_trials"/>
    <Routine name="Dialogue"/>
    <LoopTerminator name="instruction"/>
    <Routine name="StartTimer"/>
    <LoopInitiator loopType="TrialHandler" name="training">
      <Param name="Selected rows" updates="None" val="" valType="str"/>
      <Param name="conditions" updates="None" val="None" valType="str"/>
      <Param name="conditionsFile" updates="None" val="" valType="file"/>
      <Param name="endPoints" updates="None" val="[0, 1]" valType="num"/>
      <Param name="isTrials" updates="None" val="False" valType="bool"/>
      <Param name="loopType" updates="None" val="sequential" valType="str"/>
      <Param name="nReps" updates="None" val="999 if expInfo['skip_training'] == False else 0" valType="num"/>
      <Param name="name" updates="None" val="training" valType="code"/>
      <Param name="random seed" updates="None" val="" valType="code"/>
    </LoopInitiator>
    <LoopInitiator loopType="TrialHandler" name="training_trials">
      <Param name="Selected rows" updates="None" val="" valType="str"/>
      <Param name="conditions" updates="None" val="[]" valType="str"/>
      <Param name="conditionsFile" updates="None" val="conditions_temp_train.csv" valType="file"/>
      <Param name="endPoints" updates="None" val="[0, 1]" valType="num"/>
      <Param name="isTrials" updates="None" val="True" valType="bool"/>
      <Param name="loopType" updates="None" val="random" valType="str"/>
      <Param name="nReps" updates="None" val="nReps_train" valType="num"/>
      <Param name="name" updates="None" val="training_trials" valType="code"/>
      <Param name="random seed" updates="None" val="seed + 1" valType="code"/>
    </LoopInitiator>
    <Routine name="Wait"/>
    <Routine name="Fixation"/>
    <Routine name="Stimulus"/>
    <Routine name="Blank"/>
    <LoopTerminator name="training_trials"/>
    <Routine name="Dialogue"/>
    <LoopTerminator name="training"/>
    <LoopInitiator loopType="TrialHandler" name="testing_trials">
      <Param name="Selected rows" updates="None" val="" valType="str"/>
      <Param name="conditions" updates="None" val="[OrderedDict([('n_row', np.int64(1)), ('orientation_degrees', np.int64(90)), ('session', np.int64(0)), ('stimulus_frames', np.int64(1)), ('stimulus_duration_s', np.float64(0.02)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'test')]), OrderedDict([('n_row', np.int64(1)), ('orientation_degrees', np.int64(0)), ('session', np.int64(0)), ('stimulus_frames', np.int64(1)), ('stimulus_duration_s', np.float64(0.02)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'test')]), OrderedDict([('n_row', np.int64(12)), ('orientation_degrees', np.int64(90)), ('session', np.int64(0)), ('stimulus_frames', np.int64(1)), ('stimulus_duration_s', np.float64(0.02)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'test')]), OrderedDict([('n_row', np.int64(12)), ('orientation_degrees', np.int64(0)), ('session', np.int64(0)), ('stimulus_frames', np.int64(1)), ('stimulus_duration_s', np.float64(0.02)), ('x_eccentricity_degrees', np.float64(5.0)), ('y_eccentricity_degrees', np.float64(2.5)), ('state', 'test')])]" valType="str"/>
      <Param name="conditionsFile" updates="None" val="conditions_temp_test.csv" valType="file"/>
      <Param name="endPoints" updates="None" val="[0, 1]" valType="num"/>
      <Param name="isTrials" updates="None" val="True" valType="bool"/>
      <Param name="loopType" updates="None" val="random" valType="str"/>
      <Param name="nReps" updates="None" val="nReps_test if expInfo[&quot;skip_testing&quot;] == False else 0" valType="num"/>
      <Param name="name" updates="None" val="testing_trials" valType="code"/>
      <Param name="random seed" updates="None" val="seed" valType="code"/>
    </LoopInitiator>
    <Routine name="Wait"/>
    <Routine name="Fixation"/>
    <Routine name="Stimulus"/>
    <Routine name="Blank"/>
    <LoopTerminator name="testing_trials"/>
    <Routine name="Break"/>
    <Routine name="QandASession"/>
    <Routine name="SaveData"/>
    <Routine name="End"/>
  </Flow>
</PsychoPy2experiment>
